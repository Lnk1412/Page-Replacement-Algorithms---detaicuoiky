#include <iostream>
#include <vector>
#include <string>
using namespace std;

int main() {
    int capacity;
    cout << "Nhap so khung trang: ";
    cin >> capacity;

    string ref;
    cout << "Nhap chuoi tham chieu: ";
    cin >> ref;

    vector<int> frames;
    int page_faults = 0;

    cout << "\nQua trinh thay the trang (LRU):\n";

    for (int i = 0; i < (int)ref.size(); i++) {
        int page = ref[i] - '0';
        bool hit = false;

        for (int x : frames) {
            if (x == page) {
                hit = true;
                break;
            }
        }

        if (!hit) {
            if ((int)frames.size() < capacity) {
                frames.push_back(page);
            } else {
                int idx_to_replace = -1;
                int least_recent = i;

                for (int j = 0; j < (int)frames.size(); j++) {
                    int last_use = -1;
                    for (int k = i - 1; k >= 0; k--) {
                        if (frames[j] == ref[k] - '0') {
                            last_use = k;
                            break;
                        }
                    }
                    if (last_use < least_recent) {
                        least_recent = last_use;
                        idx_to_replace = j;
                    }
                }

                frames[idx_to_replace] = page;
            }
            page_faults++;
        }

        cout << "Trang " << page << " -> [ ";
        for (int x : frames) cout << x << " ";
        cout << "]" << (hit ? " (hit)" : " (loi trang)") << "\n";
    }

    cout << "\nTong so loi trang = " << page_faults << endl;
    return 0;
}
